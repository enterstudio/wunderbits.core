(function(){"use strict";function a(a){var b=d,c=a;"string"==typeof a&&(c=a.split("/"));for(var e,f;c.length;)f=c.shift(),e=b[f],e||(e=b[f]={}),b=e;return b}function b(b,c){var d,e=b.split("/"),f=c.split("/");for(e.pop();f.length;)d=f.shift(),".."===d?e.pop():"."!==d&&e.push(d);return a(e)}function c(c,d,e){d=d.map(function(a){return"."===a[0]?b(c,a):a});var f=c.split("/");c=f.pop();var g=a(f);g[c]=e.apply(null,d)}var d=window,e=d.define;"function"==typeof e&&e.amd||(d.define=c)}).call(this),define("wunderbits/core/lib/assert",[],function(){function a(a,b){if(!a)throw new Error(b||"")}function b(b){a[b]=function(c,d){a(typeof c===b,d)}}var c=Array.isArray;a.empty=function(b,d){var e=c(b)?b:Object.keys(b);a(0===e.length,d)},a.array=function(b,d){a(c(b),d)};for(var d=["undefined","boolean","number","string","function","object"];d.length;)b(d.shift());return a}),define("wunderbits/core/lib/merge",[],function(){return function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}}),define("wunderbits/core/lib/extend",["./assert","./merge"],function(a,b){return function(){var c=[].slice.call(arguments);a(c.length>0,"extend expect one or more objects");for(var d=c.shift();c.length;)b(d,c.shift());return d}}),define("wunderbits/core/lib/createUID",[],function(){function a(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)}return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a)}}),define("wunderbits/core/WBClass",["./lib/extend","./lib/createUID"],function(a,b){function c(a,b){a=a||{};var d=a.mixins||[];delete a.mixins;for(var e,g=f(this,a,b);d.length;)e=d.shift(),"function"==typeof e.applyToClass&&e.applyToClass(g);return g.extend=c,g}function d(a){var c=this;c.uid=b(),c.options=a||c.options,c.initialize.apply(c,arguments),c.initMixins.apply(c,arguments)}var e=function(){},f=function(b,c,d){var f;return f=c&&c.hasOwnProperty("constructor")?c.constructor:function(){return b.apply(this,arguments)},a(f,b),e.prototype=b.prototype,f.prototype=new e,a(f.prototype,c),f.prototype.constructor=f,a(f,d),f.__super__=b.prototype,f};return a(d.prototype,{initialize:function(){var a=this;return a},initMixins:function(){for(var a,b=this,c=b.initializers||[];c.length;)a=c.shift(),"function"==typeof a&&a.apply(b,arguments)}}),d.extend=c,d}),define("wunderbits/core/WBSingleton",["./lib/extend","./lib/createUID"],function(a,b,c){function d(a,b){for(var c;a.length;)c=a.shift(),"function"==typeof c.applyTo&&c.applyTo(b)}function e(h){h=h||{};var i=this||g;f.prototype=i;var j=new f,k=h.mixins||[];return h.mixins=c,d(k,j),a(j,h),j.extend=e,j.uid=b(),j}var f=function(){};f.prototype={extend:e};var g=new f;return g}),define("wunderbits/core/lib/clone",[],function(){function a(a){return a.slice()}function b(a){return new Date(a)}function c(a){var c={};for(var e in a)if(a.hasOwnProperty(e)){var f=a[e];c[e]=f instanceof Date?b(f):"object"==typeof f&&null!==f?d(f):f}return c}function d(b){return e(b)?a(b):c(b)}var e=Array.isArray;return d}),define("wunderbits/core/WBMixin",["./lib/extend","./lib/clone","./WBSingleton"],function(a,b,c){var d=c.extend({applyTo:function(c){var d,e=b(this.Behavior);return"function"==typeof e.initialize&&(d=e.initialize,delete e.initialize),a(c,e),d&&d.apply(c),c},applyToClass:function(c){var d=c.prototype;if(!d||d.constructor!==c)throw new Error("applyToClass expects a class");var e=b(this.Behavior),f=e.initialize;if("function"==typeof f){var g=d.initializers=d.initializers||[];g.push(f),delete e.initialize}return a(d,e),c}});return d.extend=function(e,f){e||(e={}),f||(f={});var g=b(this.Behavior);f.Behavior=a(g,e);var h=c.extend.call(this,f);return h.extend=d.extend,h},d}),define("wunderbits/core/WBPromise",["./WBClass"],function(a){function b(a){return function(){var b=this.deferred;return b[a].apply(b,arguments)}}var c={constructor:function(a){this.deferred=a}};return["state","done","fail","then","promise"].forEach(function(a){c[a]=b(a)}),c.always=c.then,a.extend(c)}),define("wunderbits/core/WBDeferred",["./WBClass","./WBPromise"],function(a,b){function c(a,b,c){return function(){var f=this;if(!(f instanceof h))throw new Error(c+" invoked with wrong context");if(f._state!==e.pending)return f;f._args=d.slice.call(arguments);var g=b?f._args.shift():void 0;return f._state=a,f.trigger(g),f}}var d=[],e={pending:0,resolved:2,rejected:4},f={0:["pending"],2:["resolved","resolve"],4:["rejected","reject"]},g={constructor:function(){var a=this;a._state=e.pending,a._args=[],a.handlers=[]},state:function(){var a=this;return f[a._state][0]},trigger:function(a){var b=this;if(b._state!==e.pending)for(var c,d=b.handlers;d.length;)c=d.shift(),b.invoke(c,a)},invoke:function(a,b){var c=this,d=c._state,f=a.context||b||c,g=a.args;c._args.forEach(function(a){g.push(a)});var h=a.type,i="then"===h||"done"===h&&d===e.resolved||"fail"===h&&d===e.rejected;i&&a.fn.apply(f,g)},promise:function(){var a=this;return a._promise=a._promise||new b(this),a._promise}};["then","done","fail"].forEach(function(a){g[a]=function(){var b=this,c=d.slice.call(arguments),e=c.shift(),f=c.shift();return b.handlers.push({type:a,context:f,fn:e,args:c}),b.trigger(),b}}),g.always=g.then,[e.resolved,e.rejected].forEach(function(a){var b=f[a][1];g[b]=c(a,!1,b),g[b+"With"]=c(a,!0,b)});var h=a.extend(g);return h}),define("wunderbits/core/When",["./WBSingleton","./WBDeferred"],function(a,b){var c=[],d=a.extend({when:function(){function a(){f.rejectWith(this)}function d(){if("rejected"!==f.state()){var a=h-g.length-1;if(i[a]=c.slice.call(arguments),g.length){var b=g.shift();b.done(d)}else i.unshift(this),f.resolveWith.apply(f,i)}}var e=this,f=new b(e),g=c.slice.call(arguments),h=g.length,i=new Array(h);if(g.length){g.forEach(function(b){b.fail(a)});var j=g.shift();j.done(d)}else f.resolve();return f.promise()}});return d}),define("wunderbits/core/lib/toArray",[],function(){return function(a,b){return[].slice.call(a,b||0)}}),define("wunderbits/core/lib/events",["./assert","./toArray","./clone"],function(a,b,c){var d=/\s+/,e={trigger:"Cannot trigger event(s) without event name(s)",events:"Cannot bind/unbind without valid event name(s)",callback:"Cannot bind/unbind to an event without valid callback function"},f={initialize:function(){var a=this;a._events={},a._cache={}},on:function(b,c,d){var f=this;return a.string(b,e.events),a.function(c,e.callback),f.iterate(b,function(a){f.bind(a,c,d);var b=f._cache;b[a]&&c.apply(d||f,b[a])}),f},off:function(b,c,d){var f=this;return b&&a.string(b,e.events),b||c||d?(b=b||Object.keys(f._events),f.iterate(b,function(a){f.unbind(a,c,d)}),f):(f._events={},f)},once:function(a,c,d){var e=this,f=b(arguments);return f[1]=function(){e.off.apply(e,f),c.apply(d||e,arguments)},e.on.apply(e,f),e},publish:function(c){var d=this,f=b(arguments);return a.string(c,e.events),d.iterate(c,function(a){var b=d._cache;b[a]||(b[a]=f.slice(1),f[0]=a,d.trigger.apply(d,f))}),d},unpublish:function(b){var c=this;return a.string(b,e.events),c.iterate(b,function(a){c._cache[a]=void 0}),c},unpublishAll:function(){var a=this;return a._cache={},a},trigger:function(c){var d=this;a.string(c,e.trigger);var f=b(arguments,1);return d.iterate(c,function(a){d.triggerEvent(a,f)}),d},triggerEvent:function(a,b){for(var c=this,d=c._events,e=[],f=a.split(":");f.length;)e.push(f.shift()),a=e.join(":"),a in d&&c.triggerSection(a,f,b)},triggerSection:function(a,b,d){var e=this,f=e._events,g=f[a]||[];g.forEach(function(a){var f;b.length&&(f=c(d),f.unshift(b)),a.callback.apply(a.context||e,f||d)})},iterate:function(b,c){var e=this;for("string"==typeof b?b=b.split(d):a.array(b);b.length;)c.call(e,b.shift())},bind:function(a,b,c){var d=this,e=d._events,f=e[a]||(e[a]=[]);return f.push({callback:b,context:c}),d},unbind:function(a,b,c){for(var d,e=this,f=e._events,g=f[a]||[],h=[],i=-1,j=g.length;++i<j;)d=g[i],(b&&b!==d.callback||c&&c!==d.context)&&h.push(d);return f[a]=h,e}};return f}),define("wunderbits/core/mixins/WBEventsMixin",["../WBMixin","../lib/events"],function(a,b){return a.extend(b)});