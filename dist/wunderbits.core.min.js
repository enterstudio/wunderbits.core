(function(){"use strict";function a(a){var b=d,c=a;"string"==typeof a&&(c=a.split("/"));for(var e,f;c.length;)f=c.shift(),e=b[f],e||(e=b[f]={}),b=e;return b}function b(b,c){var d,e=b.split("/"),f=c.split("/");for(e.pop();f.length;)d=f.shift(),".."===d?e.pop():"."!==d&&e.push(d);return a(e)}function c(c,d,e){d=d.map(function(a){return"."===a[0]?b(c,a):a});var f=c.split("/");c=f.pop();var g=a(f);g[c]=e.apply(null,d)}var d=window,e=d.define;"function"==typeof e&&e.amd||(d.define=c)}).call(this),define("wunderbits/core/lib/assert",[],function(){function a(a,b){if(!a)throw new Error(b||"")}function b(b){a[b]=function(c,d){a(typeof c===b,d)}}var c=Array.isArray;a.empty=function(b,d){var e=c(b)?b:Object.keys(b);a(0===e.length,d)},a.array=function(b,d){a(c(b),d)};for(var d=["undefined","boolean","number","string","function","object"];d.length;)b(d.shift());return a}),define("wunderbits/core/lib/merge",[],function(){return function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}}),define("wunderbits/core/lib/extend",["./assert","./merge"],function(a,b){return function(){var c=[].slice.call(arguments);a(c.length>0,"extend expect one or more objects");for(var d=c.shift();c.length;)b(d,c.shift());return d}}),define("wunderbits/core/lib/createUID",[],function(){function a(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)}return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a)}}),define("wunderbits/core/WBClass",["./lib/extend","./lib/createUID"],function(a,b){function c(a,b){a=a||{};var d=a.mixins||[];delete a.mixins;for(var e,g=f(this,a,b);d.length;)e=d.shift(),"function"==typeof e.applyToClass&&e.applyToClass(g);return g.extend=c,g}function d(a){var c=this;c.uid=b(),c.options=a||c.options,c.initialize.apply(c,arguments),c.initMixins.apply(c,arguments)}var e=function(){},f=function(b,c,d){var f;return f=c&&c.hasOwnProperty("constructor")?c.constructor:function(){return b.apply(this,arguments)},a(f,b),e.prototype=b.prototype,f.prototype=new e,a(f.prototype,c),f.prototype.constructor=f,a(f,d),f.__super__=b.prototype,f};return a(d.prototype,{initialize:function(){var a=this;return a},initMixins:function(){for(var a,b=this,c=b.initializers||[];c.length;)a=c.shift(),"function"==typeof a&&a.apply(b,arguments)}}),d.extend=c,d}),define("wunderbits/core/lib/toArray",[],function(){return function(a,b){return[].slice.call(a,b||0)}}),define("wunderbits/core/WBEvents",["./lib/assert","./lib/toArray"],function(a,b){var c=/\s+/,d={trigger:"Cannot trigger event(s) without event name(s)",events:"Cannot bind/unbind without valid event name(s)",callback:"Cannot bind/unbind to an event without valid callback"},e={on:function(a,b,c){var d=f(this,"on",a,[b,c]);if(!d||!b)return this;this._events||(this._events={});var e=this._events[a]||(this._events[a]=[]);return e.push({callback:b,context:c,ctx:c||this}),this},off:function(a,b,c){var d,e,g,h,i,j,k,l,m=f(this,"off",a,[b,c]);if(!this._events||!m)return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:Object.keys(this._events),i=0,j=h.length;j>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=d=[],b||c)for(k=0,l=g.length;l>k;k++)e=g[k],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=[].slice.call(arguments,1);if(!f(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&g(c,b),d&&g(d,arguments),this}},f=function(a,b,d,e){if(!d)return!0;if("object"==typeof d){for(var f in d)a[b].apply(a,[f,d[f]].concat(e));return!1}if(c.test(d)){for(var g=d.split(c),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(e));return!1}return!0},g=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);break;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);break;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);break;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);break;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}};return e.bind=e.on,e.unbind=e.off,{_eventArgsMap:{},on:function(b,c,f){var g=this;return a.string(b,d.events),a.function(c,d.callback),g.iterateOverEvents(b,function(a){var b=g._eventArgsMap[a];b&&c.apply(f||g,b)}),e.on.apply(this,arguments),g},trigger:function(c){a.string(c,d.trigger);var e=this,f=b(arguments);return e.iterateOverEvents(c,e.triggerEvent,f),e},triggerEvent:function(a,b){for(var c,d,f,g,h=this,i="",j=[],k=a.split(":");k.length;)f=k.shift(),d={},i&&(i+=":"),i+=f,g=c||k,c=g.slice(1),d.fragments=c,d.channel=i,j.push(d);for(j.reverse();j.length;)d=j.shift(),g=[d.channel],d.fragments.length&&g.push(d.fragments),g.push.apply(g,b.slice(1)),e.trigger.apply(h,g);var l=[a].concat(b.slice(1));h.triggered&&h.triggered.apply(h,l)},off:function(b){var c=this;b&&a.string(b,d.events);var f=c.on;return c.on=e.on,e.off.apply(c,arguments),c.on=f,c},once:function(){var a=this,c=b(arguments),d=c[1];return"function"==typeof d&&(c[1]=function(){e.off.apply(a,c),d.apply(c[2]||a,arguments)}),a.on.apply(a,c),a},publish:function(b){var c=this,f=Array.prototype.slice.call(arguments,1);return a.string(b,d.events),c.iterateOverEvents(b,function(a){if(!c._eventArgsMap[a]){c._eventArgsMap[a]=f;var b=[a].concat(f);e.trigger.apply(c,b)}}),c},unpublish:function(b){var c=this;return a.string(b,d.events),c.iterateOverEvents(b,function(a){delete c._eventArgsMap[a]}),c},unpublishAll:function(){var a=this;return a._eventArgsMap={},a},iterateOverEvents:function(a,d){var e=this,f=a.split(c),g=b(arguments,2);for(g.unshift(null);f.length;)g[0]=f.shift(),d.apply(e,g)}}}),define("wunderbits/core/WBSingleton",["./lib/extend","./lib/createUID","./WBEvents","./WBClass"],function(a,b,c,d,e){function f(a,b){for(var c;a.length;)c=a.shift(),"function"==typeof c.applyTo&&c.applyTo(b)}var g=d.extend({initialize:function(){throw new Error("Cannot create instance of singleton class")}});return g.extend=function(h){h=h||{};var i=new d,j=this||g;a(i,j);var k=h.mixins||[];return h.mixins=e,f(k,i),a(i,c,h),i.extend=g.extend,i.uid=b(),i},g}),define("wunderbits/core/lib/clone",[],function(){function a(a){return a.slice()}function b(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function c(c){return d(c)?a(c):b(c)}var d=Array.isArray;return c}),define("wunderbits/core/WBMixin",["./lib/extend","./lib/clone","./WBSingleton"],function(a,b,c){var d=c.extend({applyTo:function(c){var d,e=b(this.Behavior);return"function"==typeof e.initialize&&(d=e.initialize,delete e.initialize),a(c,e),d&&d.apply(c),c},applyToClass:function(c){var d=c.prototype;if(!d||!d.constructor)throw new Error("applyToClass expects a class");var e=b(this.Behavior),f=e.initialize;if("function"==typeof f){var g=d.initializers=d.initializers||[];g.push(f),delete e.initialize}return a(d,e),c}});return d.extend=function(e,f){e||(e={}),f||(f={});var g=b(this.Behavior);f.Behavior=a(g,e);var h=c.extend.call(this,f);return h.extend=d.extend,h},d});